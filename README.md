# DataAnalytics-Assessment

Task one
The aim of the first question was to identify customers that had funded both savings plan and investment plan.
I started by using the SELECT statement to show the customer details and their total deposits. I used the JOIN clause to attach the customers to their savings account through their common link (id/owner_id), and also connect each plan to the corresponding savings account. Then I filtered out customers that had not funded their savings plan using the WHERE clause. I went on to group the results by user, to see each customer on a single row alongside their total deposits. Then I used the HAVING clause with conditional aggregation t ocount the number of savings and investment plans of each customer and also ensure each customer has at least one savings plan funded and one investment plan funded. To display the savings_count and investment_count in the final output, I included them in the SELECT statement.

Task three
The third task was to find accounts with no inflow over the last year, whether savings or investment account. I started by selecting the plan id, user id, the account type, the last transaction date, and calculated the inactive days. The case function was used here to set the type of account, max (transaction date) was used to get the most recent date, datediff returns the number of days between two date values, in this case I used it to show the length of time (number of days) since the last transaction. I moved on to join the plans table and savongs table using the LEFT JOIN beacause I needed info from the plans table and corressponding info from the savings table (i.e confirmed amount with valid transactions). I went on to group my result by the plan id and owner id and type, then sorted the result by inactive days in descending order.
The challenge while solving this task was figuring out the join clause to use, therefore I went back to look into what the different JOINS do, and since the left join aligned with the problem at hand I went for it, given that it was just a corresponding match I needed from the second table to aid in my calculations.

Task four
Here the task was to estimate customer lifetime value for the marketing team. It involved a lot of calculations and tested my knowledge on aggregate functions.
After selecting the customer id and name, I used the TIMESTAMPDIFF function to calculate the number of months for which the account has been in existence. Then the COUNT function to get the total number of transactions. Now calculating the clv, although given the formula, I still had to get the average profit per transction by dividing the total sum of confirmed amount and total number of transactions and multiplying by 10%. All the values for amount were in kobo so I had to divide by 100 to convert to naira at the end of the entire calculation. I used the ROUND function to estimate the final values to 2 decimal places.
